# Kickoff Meeting — Go URL Shortener (Quera Bootcamp)
**Date:** 2026-02-25  
**Time:** 17:00–18:00 (Europe/Madrid)  
**Location:** Google Meet (link: <paste_link_here>)  
**Notes owner:** Reza  
**Channel:** Telegram (links-only announcements)

---

## Attendees
- Reza
- Amir Hasan

---

## Goal (what we must leave with)
- MVP scope + Definition of Done
- Initial API contract direction
- Tech stack decisions
- Workflow (Docs-as-Code + GitHub Issues/PR)
- 2-week plan (owners + next actions)

---

## Problem statement (1-minute summary)
Marketing URLs are often long and error-prone to share. We will build an internal URL shortener that:
- lets authenticated users create short links
- redirects public visitors to the original URL
- tracks minimum analytics (click count)
- provides admin controls for users/URLs

---

## Decisions (locked)

### Tech stack
- HTTP framework: **Fiber**
- Database: **PostgreSQL**
- ORM: **GORM**
- Migrations: **golang-migrate/migrate**
- Auth: **JWT (access token for MVP)**
- Password hashing: **Argon2**
- Logging: **zerolog**
- Default branch: **main** (protected, PR-only merges, CI required)

> ADR links:
- [ADR-0001: Use Fiber](../adr/0001-use-fiber.md)
- [ADR-0002: Use PostgreSQL + GORM](../adr/0002-use-postgres-gorm.md)
- [ADR-0003: JWT access tokens](../adr/0003-auth-jwt-access-token.md)
- [ADR-0004: Argon2 password hashing](../adr/0004-password-hashing-argon2.md)
- [ADR-0005: Short code strategy](../adr/0005-shortcode-strategy.md)
- [ADR-0006: Error format](../adr/0006-error-format.md)
- [ADR-0007: Redirect policy](../adr/0007-redirect-policy.md)
- [ADR-0008: Logging](../adr/0008-logging-zerolog.md)

### Product rules (MVP)
- Redirect: **302**
- Short code: **random Base62, length 7**, DB unique index on `short_code`, retry on collision (max 5)
- URL validation: allow **http/https**, must be parseable with host (optional: block localhost/private IP)
- Analytics: minimum **click_count**, increment must be atomic in DB

---

## MVP Scope (delivery by end of Week 2)

### Must-have
- Auth: register/login + JWT middleware + RBAC (user/admin)
- URLs: create short URL, list own URLs
- Public redirect: `GET /:shortCode` with 302 + click_count++
- Admin basics: list users, list URLs, disable URL (minimum 1 admin action)
- Engineering: Docker dev/prod, tests (core+auth), docs (API+DB+run+test)

### Non-goals (for MVP)
- custom alias, expiration, QR, redis cache, rate limiting, detailed analytics table

---

## Definition of Done (MVP)
- End-to-end flow works: register → login → shorten → redirect → click_count increments
- Admin endpoints require role=admin (user gets 403)
- Runs on clean machine via Docker
- `go test ./...` passes
- Docs allow a new developer to run + test without help

---

## Working agreement (simple rules to avoid rework)
- Every work starts with a GitHub Issue.
- Branch naming: `feat/<short>-#<issue>` or `chore/<short>-#<issue>`
- PR must link issue using: `Closes #<issue>`
- Telegram is links-only (PR/Issue/ADR/meeting). Decisions go to ADR or issue comment.
- Small PRs (1 feature per PR) to avoid conflicts.

---

# Two-week plan (2 people, low complexity, low risk)

## Week 1 — “Core End-to-End MVP Flow”
**Target by end of Week 1:**  
We can demo: register/login → shorten → public redirect → click_count increases.  
(Without admin, but with clean structure and DB working.)

### Reza (DB + DevOps + Docs alignment)
- Create migrations for `users` and `urls` (unique email, unique short_code, click_count, is_disabled)
- Wire Postgres + GORM base connection (env-based)
- Docker compose dev (app + postgres) + `.env.example`
- Keep docs synced (docs/api.md + runbook migration commands)

### Amir Hasan (API + Auth + Core endpoints)
- Fiber setup + `/api/v1` group + `GET /api/v1/health`
- Auth: register/login (Argon2 + JWT access token)
- JWT middleware (auth) + role middleware (admin-only placeholder)
- URL endpoints:
    - `POST /api/v1/urls` (create short URL)
    - `GET /api/v1/urls` (list own URLs)
    - `GET /:shortCode` (public redirect 302 + triggers click increment)

### Week 1 acceptance checklist
- [ ] `docker compose up --build` brings up app + DB
- [ ] Register & login work; token issued
- [ ] Shorten works and saves to DB with unique short_code
- [ ] Public redirect works (302) and increments click_count atomically
- [ ] Minimal logging enabled (zerolog)
- [ ] `go test ./...` passes (even with minimal tests)

---

## Week 2 — “Admin + Hardening + Final Quality”
**Target by end of Week 2:**  
MVP complete: admin basics + tests + polished docs + CI stable.

### Reza (Quality + tests + CI hardening + final docs)
- Add/expand tests:
    - service unit tests (short code generator, url validation)
    - minimum integration test (happy path E2E)
- Finalize runbook (migrations, env, troubleshooting)
- Ensure CI + branch protection are re-enabled (1 approval, CI required)
- Prepare short demo script (2 minutes)

### Amir Hasan (Admin endpoints + error consistency + polish)
- Admin endpoints (JWT + role=admin):
    - `GET /api/v1/admin/users`
    - `GET /api/v1/admin/urls`
    - `PATCH /api/v1/admin/urls/:id/disable`
- Ensure consistent error format and status codes across endpoints
- Add request_id middleware + structured logging fields (method/path/status/latency)

### Week 2 acceptance checklist (final delivery)
- [ ] Admin endpoints work and enforce RBAC (403 for non-admin)
- [ ] Consistent error format everywhere
- [ ] Docker dev + production Dockerfile present (multi-stage recommended)
- [ ] Tests pass locally and in CI
- [ ] Docs complete enough for a new developer to run without help

---

## Action items (create GitHub Issues after kickoff)
> Keep issues small. Use labels: type:* , area:* , priority:*

### Week 1 issues (recommended minimum set)
1) DB migrations (users, urls, indexes) — Reza
2) Docker compose dev + env example — Reza
3) Fiber setup + health endpoint — Amir Hasan
4) Auth register/login (Argon2 + JWT) — Amir Hasan
5) JWT middleware + RBAC middleware — Amir Hasan
6) POST /urls shorten — Amir Hasan
7) GET /:shortCode redirect + atomic click increment — Amir Hasan + Reza (DB part)
8) GET /urls list own — Amir Hasan

### Week 2 issues (recommended)
9) Admin endpoints — Amir Hasan
10) Tests (unit + 1 integration) — Reza
11) Docker prod + runbook final — Reza
12) Error/Logging polish — Amir Hasan

---

## Parking lot (decide later)
- Rate limiting
- Redis caching
- Detailed analytics (url_visits table)
- Metrics/observability
- Refresh tokens